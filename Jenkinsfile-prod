pipeline {
  agent any
  stages {
  
stage('helm repo check out ') {
      steps {
      git branch: 'main', url: 'https://github.com/ckaruthapandi/devops.git'
      }
    }
     stage('deploy to helm ') {
      steps {
            sh 'kubectl apply -f my-namespace.yaml'
            sh 'helm upgrade --install nodejsdev  nodejs --values nodejs/values.yaml --set image.tag=qalatest -n prod'
            sh 'cat nodejs/values.yaml'
            }
    }
}
  post 
  {
      always
      {
          cleanWs()
          slackSend channel: 'kp-devops', message: "pipeline status -${currentBuild.currentResult}"
        }
   }
}
